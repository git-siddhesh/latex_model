
































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































 71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                        | 4000/5649 [7:19:33<2:40:01,  5.82s/it]
{'loss': 4.9764, 'grad_norm': 3.7250382900238037, 'learning_rate': 4.050470097769603e-06, 'epoch': 0.71}



























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 47521/47526 [35:08<00:00, 36.65it/s]















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 5648/5649 [10:57:57<00:07,  7.08s/it]
{'train_runtime': 39485.49, 'train_samples_per_second': 4.579, 'train_steps_per_second': 0.143, 'train_loss': 4.710553807228049, 'epoch': 1.0}
***** Train results ***** TrainOutput(global_step=5649, training_loss=4.710553807228049, metrics={'train_runtime': 39485.49, 'train_samples_per_second': 4.579, 'train_steps_per_second': 0.143, 'train_loss': 4.710553807228049, 'epoch': 1.0})
+----------------------------------------------------------------------------------+
GPU memory usage before cleaning cache: 39132.81 MB
GPU memory usage after cleaning cache: 23174.81 MB
GPU memory occupied from nvmlInit: 23795 MB.
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5649/5649 [10:58:02<00:00,  6.43s/it]Could not locate the best model at /home/iitgn_cse/latex_model/model_main_fp322024-04-10/latex/main_fp32_2024-04-10_ep_1_lr_2e-05_cosine_wt_decay_0.1_warmup_st_100_emb_4096_V_30000_Dhead_128_FF_14336_L_7_N_Head_32_KV_Head_8_W_4096/checkpoint-4000/pytorch_model.bin, if you are running a distributed training on multiple nodes, you should activate `--save_on_each_node`.
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5649/5649 [10:58:02<00:00,  6.99s/it]




















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 47526/47526 [34:50<00:00, 22.73it/s]
***** Eval results ***** {'eval_loss': 3.9447503089904785, 'eval_runtime': 2091.4325, 'eval_samples_per_second': 22.724, 'eval_steps_per_second': 22.724, 'epoch': 1.0}
Model saved
+----------------------------------------------------------------------------------+
GPU memory usage before cleaning cache: 23998.81 MB
GPU memory usage after cleaning cache: 23174.81 MB
GPU memory occupied from nvmlInit: 23795 MB.
+----------------------------------------------------------------------------------+
------------------------------------------------------------------------------------------
Training for 0-2
------------------------------------------------------------------------------------------
val_local_pickel_path: /home/iitgn_cse/siddhesh_tokenize_data_9-4-24/DATA_TKNZD_10-4-24/val_0_2_datasets.pkl
train_local_pickel_path: /home/iitgn_cse/siddhesh_tokenize_data_9-4-24/DATA_TKNZD_10-4-24/train_0_2_datasets.pkl
type <class 'datasets.arrow_dataset.Dataset'>
Dataset({
    features: ['input_ids', 'token_type_ids', 'attention_mask', 'num_chunks'],
    num_rows: 177569
})
Dataset({
    features: ['input_ids', 'token_type_ids', 'attention_mask', 'num_chunks'],
    num_rows: 47262
})































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                      | 3999/5549 [6:36:17<2:19:58,  5.42s/it]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                      | 4000/5549 [6:36:20<2:03:01,  4.77s/it]


































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 47257/47262 [61:21:23<00:00, 30.50it/s]

{'eval_loss': 3.4291956424713135, 'eval_runtime': 220883.9091, 'eval_samples_per_second': 0.214, 'eval_steps_per_second': 0.214, 'epoch': 0.72}












































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5549/5549 [70:38:53<00:00,  6.15s/it]Could not locate the best model at /home/iitgn_cse/latex_model/model_main_fp322024-04-10/latex/main_fp32_2024-04-10_ep_1_lr_2e-05_cosine_wt_decay_0.1_warmup_st_100_emb_4096_V_30000_Dhead_128_FF_14336_L_7_N_Head_32_KV_Head_8_W_4096/checkpoint-4000/pytorch_model.bin, if you are running a distributed training on multiple nodes, you should activate `--save_on_each_node`.
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5549/5549 [70:38:56<00:00, 45.83s/it]
{'train_runtime': 254335.8058, 'train_samples_per_second': 0.698, 'train_steps_per_second': 0.022, 'train_loss': 3.723205071437421, 'epoch': 1.0}
***** Train results ***** TrainOutput(global_step=5549, training_loss=3.723205071437421, metrics={'train_runtime': 254335.8058, 'train_samples_per_second': 0.698, 'train_steps_per_second': 0.022, 'train_loss': 3.723205071437421, 'epoch': 1.0})
+----------------------------------------------------------------------------------+
GPU memory usage before cleaning cache: 39820.81 MB
GPU memory usage after cleaning cache: 23174.81 MB
GPU memory occupied from nvmlInit: 23795 MB.
+----------------------------------------------------------------------------------+












































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 47249/47262 [33:30<00:00, 30.69it/s]

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 47262/47262 [33:31<00:00, 23.50it/s]
Model saved
+----------------------------------------------------------------------------------+
GPU memory usage before cleaning cache: 23998.81 MB
GPU memory usage after cleaning cache: 23174.81 MB
GPU memory occupied from nvmlInit: 23795 MB.
+----------------------------------------------------------------------------------+
------------------------------------------------------------------------------------------
Training for 0-3
------------------------------------------------------------------------------------------
val_local_pickel_path: /home/iitgn_cse/siddhesh_tokenize_data_9-4-24/DATA_TKNZD_10-4-24/val_0_3_datasets.pkl
train_local_pickel_path: /home/iitgn_cse/siddhesh_tokenize_data_9-4-24/DATA_TKNZD_10-4-24/train_0_3_datasets.pkl